npm init = 서버 만들어주는 라이브러리
npm install express ws = 웹소켓 연결을 뚫어주는 라이브러리
npm mongoose = mongoo db를 쉽게 사용할 수 있게 도와주는
npm cors 프론트엔드와 백엔드가 연결 통신하는게 문제 없게
dotenv 환경변수 들고오는게 필요함

## 웹소켓이란?

웹소켓(WebSocket)은 TCP 연결에 완전한 이중 통신 채널을 제공하는 컴퓨터 프로토콜이다. (HTTP와 다름 - 둘다 OSI 7계층에 위치해 있고 4계층의 TCP에 의존함. 웹소켓은 HTTP 프로토콜과 호환이 된다.)

#### 주의 - 서버와 클라이언트간의 웹소켓 연결은 HTTP 프로토콜을 통해 이루어지는데 연결이 정상적으로 이루어진다면 서버와 클라이언트 간에 웹소켓 연결(TCP/IP기반)이 이루어지고 일정 시간이 지나면 HTTP 연결은 자동으로 끊어짐.

서버와 클라이언트 간의 효율적인 양방향 통신과 데이터 전송을 실현하기 위한 구조이다.

#### HTTP는 단방향 통신 WebSocket은 양방향 통신

=> 한번의 요청으로 handshake과정을 통해 연결 유지
데이터의 실시간 업데이트가 중요한 요소기 떄문에 웹소켓은 아주 중요!

## 웹소켓의 특징

1. 양방향 통신
2. 실시간 네트워킹
   - 웹 환경에서 연속된 데이터 빠르게 노출
   - 여러 단말기에서 데이터를 빠르게 교환 (채팅, 주식, 비디오 데이터)
   - header가 상당히 작아 overhead가 적음
   - 웹소켓 프로토콜은 HTTP Polling과 같은 반이중 방식에 비해 더 낮은 부하를 사용.
3. Polling : 일정 주기로 요청을 송신하는 것
   - 실시간 네트워킹에서는 언제 통신이 발생할지 모르므로 불필요한 요청과 연결을 생성.
   - 즉, 바뀐게 없는데도 요청과 응답을 반복
4. Long Polling
   - Polling의 단점을 해결하기 위하여 서버에서 조금 더 대기를 하면서, 이벤트가 발생할 때 응답을 하는 방식.
   - 응답을 받으면 끊고 다시 요청.
   - 그러나 많은 양의 메세지가 쏟아지면 결국 Polling과 동일
5. Streaming
   - 서버에 요청 보내고 연결상태가 끊기지 않은 상태에서 끊임없이 데이터 수신
   - 클라이언트에서 서버로의 데이터 송신이 어려움
   - 세 개의 방식 모두 HTTP를 통해 통신하기 때문에 요청/응답 모두 헤더가 불필요하게 큼.

## 웹소켓 종류

### socket.io

인터넷 익스플로러 구버전의 사용자는 웹소켓으로 작성된 웹페이지를 볼 수 없다. 이를 해결하기위해 socket.io는 웹페이지가 열리는 브라우저가 웹소켓을 지원하면 일반 웹소켓 방식으로 동작하고 지원하지 않는 브라우저라면 http를 이용해 웹소켓을 흉내내는 방식으로 통신을 지원한다. socket.io는 node.js에 종속적이다.

### sockjs

spring에서 위와 같은 브라우저 문제를 해결하기 위한 방법으로 sockjs를 해결책으로 제공한다. 서버 개발시 일반 웹소켓으로 통신할지 sockjs 호환으로 통신할지 결정할 수 있다. 클라이언트는 sockjs를 통해 서버랑 통신한다.

### stomp

stomp는 단순 텍스트 지향 메시징 프로토콜이다. spring에 종속적이고, 구독방식으로 사용하고 있다. (가벼워서 많이 사용한다.)
stomp는 웹소켓 위에서 동작하는 프로토콜로써, 클라이언트와 서버가 전송할 메시지 유형, 형식, 내용들을 정의하는 매커니즘이다.

node를 이용할땐 socket.io를 주로 사용하고, spring을 사용할땐 stomp, sockjs를 주로 사용한다.
